<!DOCTYPE html>
<html lang="en">
    <head>
        <script src="http://localhost:8080/fbsql/fbsql.min.js"></script>
    </head>

    <body>
        <button id="myInput">Update</button>

        <script type="text/javascript">
            let myInput = document.getElementById("myInput");

            const conn = new Connection('my-sqlite');
            let psSelect = conn.prepareStatement("SELECT * FROM COUNTRIES WHERE COUNTRY_ID = 'AU'");
            let psUpdate = conn.prepareStatement("UPDATE COUNTRIES SET COUNTRY_DATE = :country_date, COUNTRY_TIME = :country_time, COUNTRY_TIMESTAMP = :country_timestamp WHERE COUNTRY_ID = 'AU'");

            psSelect.executeQuery()
            .then(resultSet => {
                console.log('*** read from database ***');
                console.log(`COUNTRY_DATE: ${resultSet[0].COUNTRY_DATE}`);
                console.log(`COUNTRY_TIME: ${resultSet[0].COUNTRY_TIME}`);
                console.log(`COUNTRY_TIMESTAMP: ${resultSet[0].COUNTRY_TIMESTAMP}`);
            });

            myInput.onclick = function(event) {
                var input = event.target;
                let date = new Date();
                console.log('*** update database ***');
                psUpdate.executeUpdate({country_date: date, country_time: date, country_timestamp: date})
                .then(result => {
                    /* Load image from database */
                    return psSelect.executeQuery();
                })
                .then(resultSet => {
                    console.log('*** read updated values ***');
                    console.log(`COUNTRY_DATE: ${resultSet[0].COUNTRY_DATE}`);
                    console.log(`COUNTRY_TIME: ${resultSet[0].COUNTRY_TIME}`);
                    console.log(`COUNTRY_TIMESTAMP: ${resultSet[0].COUNTRY_TIMESTAMP}`);
                });
            };
        </script>
    </body>
</html>
